<!DOCTYPE html>
<html>
<head>
    <!-- Your existing meta tags -->
    <title>My ChatGPT Archive</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        h1 { color: #333; }
        .chat { border: 1px solid #ddd; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
        .user { color: #0066cc; font-weight: bold; }
        .assistant { color: #009933; }
    </style>
</head>
<body>
    <h1>My ChatGPT Conversations</h1>
    <div id="chats"></div>

<script>
    const container = document.getElementById('chats');

    // CORRECTED GitHub API URL (remove '/adfasdfasfs/' from path)
    fetch('https://api.github.com/repos/kendiglisa/kendiglisa.github.io/contents/')
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(files => {
            // Filter only JSON files
            const jsonFiles = files.filter(file => file.name.endsWith('.json'));
            
            if (jsonFiles.length === 0) {
                container.innerHTML = "<p>No JSON chat files found in repository.</p>";
                return;
            }
            
            // Load each JSON file
            jsonFiles.forEach(file => {
                fetch(file.download_url)  // Use download_url instead of file.name
                    .then(response => {
                        if (!response.ok) {
                            console.error(`Failed to load ${file.name}`);
                            return null;
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (!data) return;
                        
                        if (data.conversations) {
                            data.conversations.forEach(chat => {
                                const chatDiv = document.createElement('div');
                                chatDiv.className = 'chat';
                                
                                const title = document.createElement('h3');
                                title.textContent = `${chat.topic || 'Chat'} - ${chat.date || 'No date'} (${file.name})`;
                                chatDiv.appendChild(title);
                                
                                chat.messages.forEach(msg => {
                                    const msgDiv = document.createElement('div');
                                    msgDiv.className = msg.role;
                                    msgDiv.innerHTML = `<strong>${msg.role}:</strong> ${msg.content}`;
                                    chatDiv.appendChild(msgDiv);
                                });
                                
                                container.appendChild(chatDiv);
                            });
                        }
                    })
                    .catch(error => console.error(`Error loading ${file.name}:`, error));
            });
        })
        .catch(error => {
            console.error('Error loading file list:', error);
            container.innerHTML = `<p>Error loading chats: ${error.message}</p>`;
        });
</script>
</body>
</html>
